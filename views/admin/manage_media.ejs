<div class="border-2 border-black p-6 mb-8 bg-white">
    <div class="flex justify-between items-center mb-4">
        <h3 class="text-xl font-bold uppercase">// Filter & Sort</h3>
        <select id="sort" onchange="sortMedia(this.value)" class="border-4 border-black p-2 font-bold focus:bg-[#FFDE59] outline-none">
            <option value="newest" <%= data.sort_order === 'newest' ? 'selected' : '' %>>Newest First</option>
            <option value="oldest" <%= data.sort_order === 'oldest' ? 'selected' : '' %>>Oldest First</option>
        </select>
    </div>
</div>

<div class="space-y-4">
    <% if (!data.media_tracks.length) { %>
        <div class="text-center mt-16 border-4 border-dashed border-black p-12 bg-neutral-50">
            <h3 class="text-2xl font-bold uppercase text-black">No files found</h3>
            <p class="mt-2 text-lg text-neutral-600">Upload some media to get started.</p>
        </div>
    <% } else { %>
        <% data.media_tracks.forEach(m => { %>
            <div class="project-row border-2 border-black p-4 flex flex-col md:flex-row justify-between items-center bg-white gap-4 hover:shadow-[4px_4px_0_0_#000] transition-shadow">
                
                <div class="flex items-center gap-4 flex-grow overflow-hidden">
                    <div class="w-12 h-12 flex-shrink-0 border-2 border-black flex items-center justify-center font-bold text-xl <%= m.mimetype.startsWith('video') ? 'bg-[#5CE1E6]' : 'bg-[#FF90E8]' %>">
                        <i class="fa-solid <%= m.mimetype.startsWith('video') ? 'fa-video' : 'fa-music' %>"></i>
                    </div>
                    <div class="min-w-0">
                        <p class="text-lg font-black uppercase truncate" title="<%= m.original_filename %>"><%= m.original_filename %></p>
                        <p class="text-xs font-mono text-neutral-600">
                            ID: <%= m.id %> | PLAYS: <%= m.plays %> | <%= new Date(m.upload_time * 1000).toLocaleDateString() %>
                        </p>
                    </div>
                </div>

                <div class="flex items-center gap-2">
                    <div id="actions-default-<%= m.id %>" class="flex gap-2">
                        <a href="<%= m.url %>" target="_blank" class="font-bold uppercase text-xs border-2 border-black px-3 py-2 hover:bg-[#FFDE59]">
                            View
                        </a>
                        <button onclick="showConfirmation('<%= m.id %>')" class="font-bold uppercase text-xs border-2 border-red-600 text-red-600 px-3 py-2 hover:bg-red-600 hover:text-white">
                            Delete
                        </button>
                    </div>

                    <div id="actions-confirm-<%= m.id %>" class="hidden flex gap-2 bg-red-50 p-1 border-2 border-red-200">
                        <span class="font-bold text-red-700 text-xs flex items-center px-2">Sure?</span>
                        <button onclick="confirmDelete('<%= m.id %>')" class="font-bold uppercase bg-red-600 text-white px-3 py-1 border-2 border-black hover:bg-red-700">Yes</button>
                        <button onclick="cancelConfirmation('<%= m.id %>')" class="font-bold uppercase text-xs border-2 border-black bg-white px-3 py-1">No</button>
                    </div>
                </div>

            </div>
        <% }) %>
    <% } %>
</div>

<% if (data.total_pages > 1) { %>
    <div class="flex justify-center gap-2 mt-8">
        <% for(let i=1; i<=data.total_pages; i++) { %>
            <a href="?page=<%= i %>&sort=<%= data.sort_order %>" class="border-2 border-black px-4 py-2 font-bold hover:bg-[#FFDE59] <%= i===data.current_page ? 'bg-black text-white' : 'bg-white' %>">
                <%= i %>
            </a>
        <% } %>
    </div>
<% } %>

<script>let currentCsrfToken = '<%= csrf_token %>';</script>
<script src="/assets/js/manage.js"></script>
